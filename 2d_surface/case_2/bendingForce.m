function [dF, dJ] = bendingForce(node0, node1, node2, kappaBar1, kappaBar2, l0, r0, EI, nu)

% This function computes the bending force and jacobian of a bending element.
% Input:  node0 - position of the first node in the bending element
%         node1 - position of the second node in the bending element
%         node2 - poisiton of the third node in the bending element
%         kappaBar1 - the natural curvature of the bending element
%         kappaBar2 - the natural curvature of the bending element
%         l0 - voronoi length of the bending element
%         r0 - local radius of bending element
%         EI - bending stiffness
%         nu - Poisson's ratio
%
% Output: dF - bending forces (6 x 1)
%         dJ - bending jacobian (6 x 6)

dF = zeros(6,1);
dJ = zeros(6,6);

xa = node0(1);
ya = node0(2);
xi = node1(1);
yi = node1(2);
xb = node2(1);
yb = node2(2);

ds = 2 * pi * l0 * r0;

l1 = sqrt((xi - xa)^2 + (yi - ya)^2);
l2 = sqrt((xb - xi)^2 + (yb - yi)^2);

t1x = (xi - xa)/l1;
t1y = (yi - ya)/l1;
t2x = (xb - xi)/l2;
t2y = (yb - yi)/l2;
tx = (t1x + t2x)/2;
ty = (t1y + t2y)/2;

kappa1 = 2 *(t1x*t2y - t1y*t2x) / ((1 + t1x*t2x + t1y*t2y)*l0);
kappa2 = ty / (sqrt(tx*tx + ty*ty)*xi);

dk1 = kappa1 - kappaBar1;
dk2 = kappa2 - kappaBar2;

dkappa1  = zeros(6,1);
dkappa2  = zeros(6,1);
ddkappa1 = zeros(6,6);
ddkappa2 = zeros(6,6);


dkappa1(1) = (2*yb - 2*yi)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));
dkappa1(2) = ((((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xb - 2*xi)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));
dkappa1(3) = (2*ya - 2*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));
dkappa1(4) = ((2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xa - 2*xb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));
dkappa1(5) = ((((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*ya - 2*yi)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));
dkappa1(6) = (2*xa - 2*xi)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1));


ddkappa1(1,1) =  ((((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xa - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xa - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*xa - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) - ((2*xa - 2*xi)*(2*yb - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);
ddkappa1(1,2) = ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((((2*xa - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(1,3) =  (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (3*(2*xa - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + (3*(2*xa - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*xa - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(2*ya - 2*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yb)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(1,4) =  (2*yb - 2*yi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - 2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((2*xa - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xb)*(2*xa - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xb)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(1,5) =  ((2*xa - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*yb - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(1,6) = 2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xa - 2*xi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*yb - 2*yi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*yb - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((((2*xa - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);

ddkappa1(2,2) =  ((((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*ya - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*ya - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*ya - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) + ((2*xb - 2*xi)*(2*ya - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);
ddkappa1(2,3) =  2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xb - 2*xi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yb)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((2*ya - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yb)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(2,4) = (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xb)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (3*(2*ya - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + (3*(2*ya - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*ya - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xb)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*ya - 2*yi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(2,5) = (2*xb - 2*xi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - 2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*ya - 2*yi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((((2*ya - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xb - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(2,6) = ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);

ddkappa1(3,3) =  (3*(2*xa - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*xb - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) + ((2*xa - 2*xi)*(2*ya - 2*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(2*ya - 2*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - 2/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(xa - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xb - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*xa - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*xb - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - ((2*xa - 2*xi)*(2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xa - 2*xi)*(2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(2*ya - 2*yb)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);
ddkappa1(3,4) =  ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((2*xa - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xa - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xb)*(2*xa - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xb)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yb)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yb)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xb)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*ya - 2*yb)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(3,5) = (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xa - 2*xi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xa - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (3*(2*xb - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*xb - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*ya - 2*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xb - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yb)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*xb - 2*xi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xb - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(3,6) =  (2*xa - 2*xi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - 2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yb)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((2*xa - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yb)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*yb - 2*yi)*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xb - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*xa - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xb - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);

ddkappa1(4,4) =  (3*(2*ya - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*yb - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) - ((2*xa - 2*xb)*(2*ya - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xb)*(2*yb - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - 2/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(ya - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*ya - 2*yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*yb - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*ya - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (3*(2*yb - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - ((2*ya - 2*yi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*ya - 2*yi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(2*xa - 2*xb)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);
ddkappa1(4,5) =  2/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*ya - 2*yi)^2/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(((2*ya - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa - 2*xb)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*ya - 2*yi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xb)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(2*ya - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xb - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*yb - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);
ddkappa1(4,6) =  (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xb)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)*(1/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*ya - 2*yi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(ya - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (3*(2*yb - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) + (3*(2*yb - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (3*(2*yb - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xb)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(2*ya - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*xa - 2*xi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*ya - 2*yi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*ya - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + ((2*yb - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*ya - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (yb - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);

ddkappa1(5,5) =  ((((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xa - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*xb - 2*xi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (3*(2*xb - 2*xi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) + ((2*xb - 2*xi)*(2*ya - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - (2*(2*ya - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);
ddkappa1(5,6) = ((((2*xb - 2*xi)*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*ya - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xa - 2*xi)*(2*xb - 2*xi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*ya - 2*yi)*(2*yb - 2*yi))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((2*xa - 2*xi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*yb - 2*yi)*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - ((2*xb - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(2*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (2*(((2*xb - 2*xi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (xa - xi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*xb - 2*xi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3);

ddkappa1(6,6) = (2*(2*xa - 2*xi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) - (2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb)/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + ((((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(ya - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(xa - xi)*(xb - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)) - (3*(2*yb - 2*yi)^2*(ya - yi)*(yb - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2) + (3*(2*yb - 2*yi)^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(4*l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) + (2*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^3) - ((2*xa - 2*xi)*(2*yb - 2*yi))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)) - ((2*yb - 2*yi)*(((2*yb - 2*yi)*(xa - xi)*(xb - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (ya - yi)/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((2*yb - 2*yi)*(ya - yi)*(yb - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*xa*yb - 2*xb*ya - 2*xa*yi + 2*xi*ya + 2*xb*yi - 2*xi*yb))/(l0*((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)*(xb - xi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) + ((ya - yi)*(yb - yi))/(((xa - xi)^2 + (ya - yi)^2)^(1/2)*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - 1)^2);

ddkappa1(2,1) = ddkappa1(1,2);
ddkappa1(3,1) = ddkappa1(1,3);
ddkappa1(4,1) = ddkappa1(1,4);
ddkappa1(5,1) = ddkappa1(1,5);
ddkappa1(6,1) = ddkappa1(1,6);

ddkappa1(3,2) = ddkappa1(2,3);
ddkappa1(4,2) = ddkappa1(2,4);
ddkappa1(5,2) = ddkappa1(2,5);
ddkappa1(6,2) = ddkappa1(2,6);

ddkappa1(4,3) = ddkappa1(3,4);
ddkappa1(5,3) = ddkappa1(3,5);
ddkappa1(6,3) = ddkappa1(3,6);

ddkappa1(5,4) = ddkappa1(4,5);
ddkappa1(6,4) = ddkappa1(4,6);

ddkappa1(6,5) = ddkappa1(5,6);


dkappa2(1) =  (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi))/(4*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
dkappa2(2) =  (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
dkappa2(3) =  ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
dkappa2(4) = (1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
dkappa2(5) =  - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
dkappa2(6) =  (1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));

ddkappa2(1,1) =  (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))^2 - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xa - 2*xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/((xa - xi)^2 + (ya - yi)^2)^(3/2) + ((2*xa - 2*xi)^2*(ya - yi)^2)/(8*((xa - xi)^2 + (ya - yi)^2)^3) + (3*(2*xa - 2*xi)^2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + (ya - yi)/(2*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (3*(2*xa - 2*xi)^2*(ya - yi))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*xa - 2*xi)*(ya - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(1,2) = (2*xa - 2*xi)/(4*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) + ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - ((2*xa - 2*xi)*(ya - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
ddkappa2(1,3) =  ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xa - 2*xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/((xa - xi)^2 + (ya - yi)^2)^(3/2) + ((2*xa - 2*xi)*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (3*(2*xa - 2*xi)^2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (ya - yi)/(2*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + (3*(2*xa - 2*xi)^2*(ya - yi))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*xa - 2*xi)*(ya - yi))/(4*xi^2*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + ((2*xa - 2*xi)*(ya - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(1,4) =  (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) + 2*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) + ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (2*xa - 2*xi)/(4*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((2*xa - 2*xi)*(ya - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
ddkappa2(1,5) =  (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + ((2*xa - 2*xi)*(2*xb - 2*xi)*(ya - yi)*(yb - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*xb - 2*xi)*(yb - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*xa - 2*xi)*(ya - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(1,6) = (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*yb - 2*yi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + ((2*xa - 2*xi)*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*xa - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(ya - yi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((2*xa - 2*xi)*(ya - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(8*xi*((xa - xi)^2 + (ya - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));

ddkappa2(2,2) =  ((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))^2 - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) - (((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/((xa - xi)^2 + (ya - yi)^2)^(3/2) + ((2*ya - 2*yi)^2*(xa - xi)^2)/(8*((xa - xi)^2 + (ya - yi)^2)^3) + (3*(2*ya - 2*yi)^2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));
ddkappa2(2,3) =  (1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*xa - 2*xi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xa - 2*xi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) + 2*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) + ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*ya - 2*yi)*(xa - xi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));
ddkappa2(2,4) = (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2))) - (((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/((xa - xi)^2 + (ya - yi)^2)^(3/2) + ((2*ya - 2*yi)*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (3*(2*ya - 2*yi)^2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));
ddkappa2(2,5) = (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((2*xb - 2*xi)*(yb - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(2,6) = (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2))) - ((2*ya - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xa - xi))/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + ((2*ya - 2*yi)*(2*yb - 2*yi)*(xa - xi)*(xb - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(3/2)*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));

ddkappa2(3,3) =  ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(xi^3*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (2*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xa - 2*xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*xb - 2*xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)^2*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) - 2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2 + 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) - 2*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));
ddkappa2(3,4) =  ((2*xa - 2*xi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + 2*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*yb - 2*yi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xa - 2*xi)/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xa - 2*xi)*(2*ya - 2*yi)*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));
ddkappa2(3,5) = ((yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xb - 2*xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)^2*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) - 2*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((2*xb - 2*xi)*(yb - yi))/(4*xi^2*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*xb - 2*xi)*(yb - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(3,6) =  ((2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))/(xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi^2*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*yb - 2*yi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + ((2*yb - 2*yi)*(xb - xi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xa - 2*xi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*xa - 2*xi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*xb - 2*xi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));

ddkappa2(4,4) =  ((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2 - 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*ya - 2*yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(ya - yi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*ya - 2*yi)^2*(xa - xi))/(8*((xa - xi)^2 + (ya - yi)^2)^(5/2)) + (3*(2*yb - 2*yi)^2*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(4,5) =  ((2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) + 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*yb - 2*yi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xb - 2*xi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + ((2*xb - 2*xi)*(yb - yi)*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - ((2*xb - 2*xi)*(yb - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(4,6) =  ((2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + ((2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) - 2*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - 1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*ya - 2*yi)*(ya - yi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) + ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*ya - 2*yi)*(xa - xi))/(4*((xa - xi)^2 + (ya - yi)^2)^(3/2)) - ((2*yb - 2*yi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2));

ddkappa2(5,5) =  (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*xb - 2*xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)^2*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2 + (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/((xb - xi)^2 + (yb - yi)^2)^(3/2) + ((2*xb - 2*xi)^2*(yb - yi)^2)/(8*((xb - xi)^2 + (yb - yi)^2)^3) - (3*(2*xb - 2*xi)^2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - (yb - yi)/(2*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) + (3*(2*xb - 2*xi)^2*(yb - yi))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - ((2*xb - 2*xi)*(yb - yi)*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));
ddkappa2(5,6) = ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(((2*yb - 2*yi)*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2))))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - 2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*yb - 2*yi)/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(xb - xi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + ((2*xb - 2*xi)*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - (2*xb - 2*xi)/(4*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*xb - 2*xi)*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*xb - 2*xi)*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(yb - yi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) - ((2*xb - 2*xi)*(yb - yi)*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(3/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) + (3*(2*xb - 2*xi)*(2*yb - 2*yi)*(yb - yi))/(8*xi*((xb - xi)^2 + (yb - yi)^2)^(5/2)*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2));

ddkappa2(6,6) = (((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*((2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2))) + 2*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2 + (((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/((xb - xi)^2 + (yb - yi)^2)^(3/2) + ((2*yb - 2*yi)^2*(xb - xi)^2)/(8*((xb - xi)^2 + (yb - yi)^2)^3) - (3*(2*yb - 2*yi)^2*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(4*((xb - xi)^2 + (yb - yi)^2)^(5/2))))/(2*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2)) - ((2*yb - 2*yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) + (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)) - (3*(2*yb - 2*yi)^2*(yb - yi))/(8*((xb - xi)^2 + (yb - yi)^2)^(5/2)))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(1/2)) - (3*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2)))^2)/(4*xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(5/2)) + ((1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2)))*(2*((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(1/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)) - ((2*yb - 2*yi)*(yb - yi))/(4*((xb - xi)^2 + (yb - yi)^2)^(3/2))) - ((2*yb - 2*yi)*((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))*(xb - xi))/(2*((xb - xi)^2 + (yb - yi)^2)^(3/2))))/(xi*(((xa - xi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (xb - xi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2 + ((ya - yi)/(2*((xa - xi)^2 + (ya - yi)^2)^(1/2)) - (yb - yi)/(2*((xb - xi)^2 + (yb - yi)^2)^(1/2)))^2)^(3/2));

ddkappa2(2,1) = ddkappa2(1,2);
ddkappa2(3,1) = ddkappa2(1,3);
ddkappa2(4,1) = ddkappa2(1,4);
ddkappa2(5,1) = ddkappa2(1,5);
ddkappa2(6,1) = ddkappa2(1,6);

ddkappa2(3,2) = ddkappa2(2,3);
ddkappa2(4,2) = ddkappa2(2,4);
ddkappa2(5,2) = ddkappa2(2,5);
ddkappa2(6,2) = ddkappa2(2,6);

ddkappa2(4,3) = ddkappa2(3,4);
ddkappa2(5,3) = ddkappa2(3,5);
ddkappa2(6,3) = ddkappa2(3,6);

ddkappa2(5,4) = ddkappa2(4,5);
ddkappa2(6,4) = ddkappa2(4,6);

ddkappa2(6,5) = ddkappa2(5,6);


dF = EI * ( dk1 * dkappa1 + dk2 * dkappa2 + nu * (dk1 * dkappa2 + dk2 * dkappa1) ) * ds;
dJ = EI * ( dkappa1 * dkappa1' + dk1 * ddkappa1 + dkappa2 * dkappa2' + dk2 * ddkappa2 + nu * (dk1 * ddkappa2 + dkappa1 * dkappa2' + dk2 * ddkappa1 + dkappa2 * dkappa1') ) * ds;

end
